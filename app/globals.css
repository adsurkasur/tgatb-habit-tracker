@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
@import url('https://fonts.googleapis.com/icon?family=Material+Icons');
@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  /* Material 3 Color System based on #6750A4 seed */
  --primary: hsl(256, 33%, 52%);
  --primary-container: hsl(259, 100%, 93%);
  --on-primary: hsl(0, 0%, 100%);
  --on-primary-container: hsl(256, 100%, 18%);
  
  --secondary: hsl(251, 14%, 41%);
  --secondary-container: hsl(258, 46%, 91%);
  --on-secondary: hsl(0, 0%, 100%);
  --on-secondary-container: hsl(251, 23%, 17%);
  
  --tertiary: hsl(336, 23%, 42%);
  --tertiary-container: hsl(337, 100%, 89%);
  
  /* Softened Light Theme - More muted and easier on eyes */
  --surface: hsl(320, 50%, 98%);
  --surface-variant: hsl(271, 20%, 95%);
  --on-surface: hsl(258, 8%, 15%);
  --on-surface-variant: hsl(251, 8%, 35%);
  
  --outline: hsl(251, 5%, 55%);
  --outline-variant: hsl(250, 8%, 85%);
  
  --success: hsl(122, 39%, 49%);
  --error: hsl(4, 90%, 58%);
  
  /* Legacy mappings for existing components - Softened */
  --header: hsl(256, 33%, 95%);
  --background: hsl(320, 50%, 98%);
  --foreground: hsl(258, 8%, 15%);
  --muted: hsl(271, 20%, 95%);
  --muted-foreground: hsl(251, 8%, 35%);
  --popover: hsl(320, 50%, 98%);
  --popover-foreground: hsl(258, 8%, 15%);
  --card: hsl(320, 50%, 98%);
  --card-foreground: hsl(258, 8%, 15%);
  --border: hsl(250, 8%, 85%);
  --input: hsl(250, 8%, 85%);
  --secondary: hsl(271, 20%, 95%);
  --secondary-foreground: hsl(258, 8%, 15%);
  --accent: hsl(271, 20%, 95%);
  --accent-foreground: hsl(258, 8%, 15%);
  --destructive: hsl(4, 90%, 58%);
  --destructive-foreground: hsl(0, 0%, 100%);
  --ring: hsl(258, 8%, 15%);
  --radius: 12px;
  
  /* Design System Custom Properties */
  --cta-bg: var(--header);
  --cta-border: hsl(var(--primary) / 0.3);
  --cta-hover-border: hsl(var(--primary) / 0.5);
  --cta-icon-bg: hsl(var(--primary) / 0.1);
  --cta-button-bg: hsl(256, 33%, 52%);
  --cta-button-hover: hsl(256, 33%, 45%);
}

.dark {
  /* Dark theme colors */
  --surface: hsl(258, 8%, 11%);
  --surface-variant: hsl(249, 7%, 19%);
  --on-surface: hsl(252, 11%, 90%);
  --primary: hsl(259, 100%, 82%);
  --primary-container: hsl(256, 54%, 27%);
  
  /* Dark mode CTA colors */
  --cta-bg: hsl(258, 8%, 13%); 
  --cta-border: hsl(249, 7%, 25%);
  --cta-hover-border: hsl(249, 7%, 35%);
  --cta-button-bg: hsl(256, 33%, 52%);
  --cta-button-hover: hsl(256, 33%, 45%);
  
  /* Dark mode header */
  --header: hsl(258, 8%, 13%);
  
  /* Legacy mappings for dark theme */
  --background: hsl(258, 8%, 11%);
  --foreground: hsl(252, 11%, 90%);
  --muted: hsl(249, 7%, 19%);
  --muted-foreground: hsl(250, 12%, 81%);
  --popover: hsl(258, 8%, 11%);
  --popover-foreground: hsl(252, 11%, 90%);
  --card: hsl(258, 8%, 11%);
  --card-foreground: hsl(252, 11%, 90%);
  --border: hsl(249, 7%, 35%);
  --input: hsl(249, 7%, 19%);
  --secondary: hsl(249, 7%, 19%);
  --secondary-foreground: hsl(252, 11%, 90%);
  --accent: hsl(249, 7%, 19%);
  --accent-foreground: hsl(252, 11%, 90%);
  --destructive: hsl(4, 90%, 58%);
  --destructive-foreground: hsl(0, 0%, 98%);
  --ring: hsl(250, 12%, 81%);
}

@layer base {
  * {
    @apply border-border;
    transition: color 0.3s cubic-bezier(0.2, 0, 0, 1), 
                background-color 0.3s cubic-bezier(0.2, 0, 0, 1), 
                border-color 0.3s cubic-bezier(0.2, 0, 0, 1),
                box-shadow 0.3s cubic-bezier(0.2, 0, 0, 1);
  }

  body {
    @apply antialiased bg-background text-foreground;
    font-family: 'Inter', sans-serif;
  }
}

@layer utilities {
  .surface-elevation-1 {
    box-shadow: 0px 1px 2px rgba(0, 0, 0, 0.3), 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
  }
  
  .surface-elevation-2 {
    box-shadow: 0 0 30px rgba(103, 80, 164, 0.25),
                0 0 60px rgba(103, 80, 164, 0.1);
  }
  
  .surface-elevation-3 {
    box-shadow: 0px 4px 8px 3px rgba(0, 0, 0, 0.15), 0px 1px 3px rgba(0, 0, 0, 0.3);
  }
  
  .state-layer-hover:hover {
    background-color: rgba(103, 80, 164, 0.08) !important;
  }

  /* Dark mode hover effect - light purple */
  .dark .state-layer-hover:hover {
    background-color: rgba(171, 149, 255, 0.15) !important;
  }
  
  .state-layer-pressed:active {
    background-color: rgba(103, 80, 164, 0.12);
  }
  
  .material-radius {
    border-radius: 12px;
  }
  
  .material-radius-lg {
    border-radius: 16px;
  }
  
  .card-transition {
    transition: box-shadow 0.3s cubic-bezier(0.2, 0, 0, 1);
  }
  
  /* Habit Card Cycling Animations - Fixed */
  .habit-card-animated {
    animation: habit-card-slide-in 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    animation-fill-mode: both;
  }
  
  /* Default slide in animation */
  @keyframes habit-card-slide-in {
    0% {
      opacity: 0;
      transform: translateX(10px) scale(0.995);
    }
    100% {
      opacity: 1;
      transform: translateX(0) scale(1);
    }
  }
  
  /* Slide from left (when moving to previous habit) */
  .habit-card-animated.slide-from-left {
    animation: habit-card-slide-from-left 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    animation-fill-mode: both;
  }
  
  @keyframes habit-card-slide-from-left {
    0% {
      opacity: 0;
      transform: translateX(-20px) scale(0.995);
    }
    100% {
      opacity: 1;
      transform: translateX(0) scale(1);
    }
  }
  
  /* Slide from right (when moving to next habit) */
  .habit-card-animated.slide-from-right {
    animation: habit-card-slide-from-right 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    animation-fill-mode: both;
  }
  
  @keyframes habit-card-slide-from-right {
    0% {
      opacity: 0;
      transform: translateX(20px) scale(0.995);
    }
    100% {
      opacity: 1;
      transform: translateX(0) scale(1);
    }
  }
  
  /* Hover effects - floating hover effect */
  .habit-card-animated {
    /* Minimal shadow when not hovered */
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
    /* Transition for smooth hover effects */
    transition: transform 0.2s ease, box-shadow 0.2s ease;
    will-change: transform;
  }
  
  .habit-card-animated:hover {
    /* Floating hover effect - same pattern as nav buttons */
    transform: translateY(-4px) scale(1.02);
    box-shadow: 0 8px 30px rgba(103, 80, 164, 0.25), 0 4px 12px rgba(0, 0, 0, 0.15);
  }
  
  /* Dark mode hover effects */
  .dark .habit-card-animated {
    /* Minimal glow when not hovered in dark mode */
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2) !important;
  }
  
  .dark .habit-card-animated:hover {
    /* Strong purple glow on hover in dark mode - same pattern as nav buttons */
    transform: translateY(-4px) scale(1.02);
    box-shadow: 0 8px 30px rgba(103, 80, 164, 0.5), 0 4px 12px rgba(0, 0, 0, 0.6) !important;
  }
  
  .drawer-overlay {
    backdrop-filter: blur(4px);
  }
  
  /* CTA Component Styles */
  .cta-card {
    background: var(--cta-bg);
    /* Minimal shadow when not hovered - same as habit cards */
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
    transition: box-shadow 0.2s ease, transform 0.2s ease;
  }
  
  .cta-card:hover {
    /* Floating hover effect with lift - same as habit cards */
    transform: translateY(-4px) scale(1.02);
    box-shadow: 0 8px 30px rgba(103, 80, 164, 0.25), 0 4px 12px rgba(0, 0, 0, 0.15);
  }
  
  /* Dark mode CTA card effects */
  .dark .cta-card {
    /* Minimal glow when not hovered in dark mode */
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2) !important;
  }
  
  .dark .cta-card:hover {
    /* Strong purple glow on hover in dark mode */
    box-shadow: 0 8px 30px rgba(103, 80, 164, 0.5), 0 4px 12px rgba(0, 0, 0, 0.6) !important;
  }
  
  /* Enhanced CTA Card Animations */
  .cta-card-animated {
    animation: cta-card-pulse 3s ease-in-out infinite;
  }
  
  .cta-card-animated:hover {
    animation: none;
  }
  
  @keyframes cta-card-pulse {
    0%, 100% {
      box-shadow: 0 4px 20px rgba(103, 80, 164, 0.2), 
                  0 0 40px rgba(103, 80, 164, 0.1);
    }
    50% {
      box-shadow: 0 6px 25px rgba(103, 80, 164, 0.25), 
                  0 0 50px rgba(103, 80, 164, 0.12);
    }
  }
  
  /* CTA Icon Animations */
  .cta-icon-container {
    transition: all 0.3s cubic-bezier(0.2, 0, 0, 1);
  }
  
  .cta-card:hover .cta-icon-container {
    background-color: hsl(var(--primary) / 0.15);
    transform: scale(1.05);
  }
  
  .cta-icon {
    transition: all 0.3s cubic-bezier(0.2, 0, 0, 1);
  }
  
  .cta-card:hover .cta-icon {
    transform: scale(1.1);
  }
  
  /* CTA Sparkle Animation */
  .cta-sparkle {
    animation: sparkle 2s ease-in-out infinite;
  }
  
  @keyframes sparkle {
    0%, 100% {
      opacity: 0.7;
      transform: scale(1);
    }
    50% {
      opacity: 1;
      transform: scale(1.2);
    }
  }
  
  .cta-button {
    background: var(--cta-button-bg);
    color: white;
    transition: background-color 0.3s cubic-bezier(0.2, 0, 0, 1), 
                transform 0.2s cubic-bezier(0.2, 0, 0, 1);
  }
  
  .cta-button:hover {
    background: var(--cta-button-hover);
    transform: scale(1.02);
  }
  
  /* Enhanced CTA Button Animations */
  .cta-button-animated {
    position: relative;
    overflow: hidden;
  }
  
  .cta-button-animated::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.5s;
  }
  
  .cta-button-animated:hover::before {
    left: 100%;
  }
  
  .dark .cta-button {
    color: hsl(var(--primary-foreground));
  }
  
  /* Floating Action Button */
  .fab {
    background: var(--cta-button-bg) !important;
    color: white !important;
    box-shadow: 0 4px 12px rgba(103, 80, 164, 0.3);
    transition: all 0.3s cubic-bezier(0.2, 0, 0, 1);
  }
  
  .fab:hover {
    background: var(--cta-button-hover) !important;
    box-shadow: 0 6px 20px rgba(103, 80, 164, 0.4);
    transform: scale(1.05);
  }
  
  /* Enhanced FAB Animations */
  .fab-animated {
    position: relative;
    overflow: hidden;
  }
  
  .fab-animated::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 50%;
    transform: translate(-50%, -50%);
    transition: width 0.3s ease, height 0.3s ease;
  }
  
  .fab-animated:active::after {
    width: 200%;
    height: 200%;
  }
  
  /* State change animation for FAB */
  .fab-animated {
    animation: fab-appear 0.4s cubic-bezier(0.2, 0, 0, 1);
  }
  
  @keyframes fab-appear {
    0% {
      opacity: 0;
      transform: scale(0.3) rotate(-180deg);
    }
    100% {
      opacity: 1;
      transform: scale(1) rotate(0deg);
    }
  }
  
  /* Pulsing effect for new FAB */
  .fab-animated:not(:hover) {
    animation: fab-appear 0.4s cubic-bezier(0.2, 0, 0, 1), 
               fab-pulse 2s ease-in-out 0.5s infinite;
  }
  
  @keyframes fab-pulse {
    0%, 100% {
      box-shadow: 0 4px 12px rgba(103, 80, 164, 0.3);
    }
    50% {
      box-shadow: 0 6px 16px rgba(103, 80, 164, 0.4);
    }
  }
  
  .dark .fab {
    color: white !important;
  }
  
  /* Dark mode header glow */
  .dark .surface-elevation-2 {
    box-shadow: 0 0 40px rgba(103, 80, 164, 0.3),
                0 0 80px rgba(103, 80, 164, 0.15);
  }
  
  /* Theme transition enhancement */
  .theme-transition {
    transition: all 0.3s cubic-bezier(0.2, 0, 0, 1);
  }
  
  /* Page transition animations */
  .page-content {
    transition: all 0.3s cubic-bezier(0.2, 0, 0, 1);
  }
  
  /* Loading state for content changes */
  .content-loading {
    opacity: 0.7;
    transform: scale(0.98);
  }
  
  /* Smooth page transitions */
  .main-content-container {
    transition: opacity 0.2s ease-in-out;
  }
  
  /* Cycling indicator animation (subtle) */
  @keyframes cycling-indicator {
    0%, 100% {
      opacity: 0.5;
    }
    50% {
      opacity: 1;
    }
  }
  
  .cycling-active {
    animation: cycling-indicator 1s ease-in-out;
  }

  /* Navigation button animations */
  .nav-button {
    backdrop-filter: blur(10px);
    /* Minimal shadow when not hovered - same as habit cards */
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
    transition: transform 0.2s ease, box-shadow 0.2s ease, backdrop-filter 0.2s ease;
  }
  
  .nav-button:hover {
    backdrop-filter: blur(15px);
    /* Floating hover effect - same as habit cards */
    transform: translate(-50%, -50%) translateY(-4px) scale(1.02);
    box-shadow: 0 8px 30px rgba(103, 80, 164, 0.25), 0 4px 12px rgba(0, 0, 0, 0.15);
  }
  
  .nav-button:active {
    transform: translate(-50%, -50%) scale(0.95);
  }
  
  /* Dark mode navigation button effects */
  .dark .nav-button {
    /* Minimal glow when not hovered in dark mode */
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2) !important;
  }
  
  .dark .nav-button:hover {
    /* Strong purple glow on hover in dark mode */
    box-shadow: 0 8px 30px rgba(103, 80, 164, 0.5), 0 4px 12px rgba(0, 0, 0, 0.6) !important;
  }
  /* Mobile responsive navigation buttons */
  @media (max-width: 640px) {
    .nav-button {
      position: relative !important;
      left: auto !important;
      right: auto !important;
      top: auto !important;
      transform: none !important;
      margin: 0 8px;
    }
    
    .nav-container-mobile {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 16px;
      width: 100%;
    }
    
    .habit-card-mobile {
      flex: 1;
      max-width: none;
    }
  }

  /* Disable hover effects */
  .no-hover:hover {
    background-color: transparent !important;
    opacity: 1 !important;
  }

  /* Enhanced collapsible animations - Ultra performance optimized with hardware acceleration */
  .collapsible-item {
    transition: transform 0.1s ease-out, background-color 0.1s ease-out;
    will-change: auto;
    /* Force GPU layer for better performance */
    transform: translateZ(0);
    backface-visibility: hidden;
  }

  .collapsible-item:hover {
    /* Use transform instead of layout-shifting properties */
    transform: translate3d(1px, 0, 0);
    background-color: rgba(var(--muted), 0.8);
  }

  /* Smooth accordion item entrance animation - hardware accelerated */
  @keyframes fadeInSlideUp {
    from {
      opacity: 0;
      transform: translate3d(0, 6px, 0);
    }
    to {
      opacity: 1;
      transform: translate3d(0, 0, 0);
    }
  }

  /* Optimized closing animation to prevent lag */
  .collapsible-closing {
    animation: fadeOutSlideDown 0.15s ease-in forwards;
  }

  @keyframes fadeOutSlideDown {
    from {
      opacity: 1;
      transform: translate3d(0, 0, 0);
    }
    to {
      opacity: 0;
      transform: translate3d(0, -4px, 0);
    }
  }

  /* Sidebar accordion trigger enhanced animations - Ultra performance optimized */
  .accordion-trigger {
    transition: background-color 0.1s ease-out;
    will-change: auto;
    /* Prevent unnecessary layer creation unless needed */
    contain: layout style;
  }

  .accordion-trigger:hover {
    background-color: rgba(var(--muted), 0.5) !important;
  }

  /* Badge count animations - Simplified */
  .badge-count {
    transition: transform 0.1s ease-out;
    will-change: auto;
  }

  .badge-count.updated {
    animation: pulse-badge 0.2s ease-out;
  }

  @keyframes pulse-badge {
    50% {
      transform: scale3d(1.05, 1.05, 1);
    }
  }

  /* Mobile full-screen dialog override */
  @media (max-width: 640px) {
    /* Target the dialog overlay */
    [data-state="open"] .fixed.inset-0 {
      background-color: transparent !important;
    }
    
    /* Target the dialog content container */
    [data-state="open"] .fixed.left-0.top-0 {
      left: 0 !important;
      top: 0 !important;
      width: 100vw !important;
      height: 100vh !important;
      padding: 0 !important;
      margin: 0 !important;
    }
    
    /* Target the actual dialog content */
    [data-mobile-fullscreen] {
      position: fixed !important;
      top: 0 !important;
      left: 0 !important;
      right: 0 !important;
      bottom: 0 !important;
      width: 100vw !important;
      height: 100vh !important;
      max-width: none !important;
      max-height: none !important;
      margin: 0 !important;
      border-radius: 0 !important;
      transform: none !important;
      border: none !important;
      box-shadow: none !important;
    }
    
    /* Hide the dialog overlay background */
    [data-state="open"] .fixed.inset-0.z-50 {
      background-color: transparent !important;
    }
  }
}
